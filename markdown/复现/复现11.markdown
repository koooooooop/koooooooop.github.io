# DeIP4CW:å¤ç°æŠ¥å‘Š

##  æ¦‚è¿°

æœ¬æŠ¥å‘Šè¯¦ç»†åˆ†æäº†å¯¹DASFAA 2023è®ºæ–‡ã€Š**A Self-decoupled Interpretable Prediction Framework for Highly-Variable Cloud Workloads**ã€‹çš„å®Œæ•´å¤ç°å®ç°ï¼ŒåŒ…å«ä»£ç ä¸åŸæ–‡çš„å¯¹æ¯”åˆ†æã€å®éªŒç»“æœéªŒè¯ä»¥åŠå¤ç°è´¨é‡è¯„ä¼°ã€‚

### ç›®æ ‡
- **æ ¸å¿ƒç®—æ³•å¤ç°**ï¼šå®ç°è®ºæ–‡ä¸­çš„è‡ªè§£è€¦é¢„æµ‹æ¡†æ¶
- **æ¶æ„ä¸€è‡´æ€§**ï¼šç¡®ä¿æ¨¡å‹æ¶æ„ä¸è®ºæ–‡æè¿°å®Œå…¨å¯¹åº”
- **æ€§èƒ½éªŒè¯**ï¼šåœ¨æ ‡å‡†æ•°æ®é›†ä¸ŠéªŒè¯æ€§èƒ½æŒ‡æ ‡
- **å¯è§£é‡Šæ€§åˆ†æ**ï¼šå®ç°è®ºæ–‡ä¸­çš„è§£é‡Šæ€§æ¡†æ¶

---

##  è®ºæ–‡æ ¸å¿ƒæŠ€æœ¯åˆ†æ

### 1. Self-decoupling Mechanism

**è®ºæ–‡æè¿°**ï¼š
> "We argue that the complicated dependencies of cloud workload signals consist of the inherent periodicity and the correlation between adjacent historical observations."

**å¤ç°å®ç°åˆ†æ**ï¼š

è®ºæ–‡ä¸­å°†å·¥ä½œè´Ÿè½½ä¿¡å·åˆ†è§£ä¸ºï¼š
$$x_t = p_t + r_t + \epsilon_t$$

å…¶ä¸­ï¼š
- $p_t$ï¼šå‘¨æœŸæ€§çŠ¶æ€ï¼ˆå…¨å±€è¶‹åŠ¿ï¼‰
- $r_t$ï¼šæ®‹å·®çŠ¶æ€ï¼ˆå±€éƒ¨æ³¢åŠ¨ï¼‰
- $\epsilon_t$ï¼šå™ªå£°é¡¹

**ä»£ç å®ç°ä¸€è‡´æ€§** ï¼š
```python
# data/preprocessor.py ä¸­çš„è§£è€¦å®ç°
def advanced_decompose(self, signal):
    """é«˜çº§åˆ†è§£æ–¹æ³• - å¯¹åº”è®ºæ–‡Algorithm 1"""
    # 1. STLåˆ†è§£è·å–è¶‹åŠ¿å’Œå­£èŠ‚æ€§
    stl = STL(signal, seasonal=13, trend=25, robust=True)
    result = stl.fit()
    
    # 2. å°æ³¢å˜æ¢è¿›ä¸€æ­¥ç»†åŒ–
    coeffs = pywt.wavedec(signal, 'db4', level=3)
    periodic_component = pywt.waverec(coeffs, 'db4')
    
    return {
        'periodic': periodic_component,      # p_t
        'residual': signal - periodic_component,  # r_t  
        'seasonal': result.seasonal,
        'trend': result.trend
    }
```

### 2. Deep Extension Learning

**è®ºæ–‡æ¶æ„**ï¼šå¤šå—çº§è”ç»“æ„
- å‘¨æœŸæ€§æ¨¡å— : å…¨å±€é•¿æœŸä¾èµ–
- è¡¥å¿æ¨¡å— : å±€éƒ¨çŸ­æœŸæ³¢åŠ¨

**å¤ç°å¯¹æ¯”** ï¼š
```python
# models/deip4cw.py - ä¸»æ¨¡å‹æ¶æ„
class DeIP4CWModel(nn.Module):
    def __init__(self, config):
        self.periodic_blocks = nn.ModuleList([
            PeriodicModule(config) for _ in range(config.num_blocks)
        ])
        self.compensation_blocks = nn.ModuleList([
            CompensationModule(config) for _ in range(config.num_blocks)  
        ])
        
    def forward(self, x):
        periodic_output = x
        compensation_output = x
        
        # å¤šå—çº§è”å¤„ç†
        for i in range(self.num_blocks):
            periodic_output = self.periodic_blocks[i](periodic_output)
            compensation_output = self.compensation_blocks[i](compensation_output)
            
        return periodic_output + compensation_output  # èåˆè¾“å‡º
```

### 3. å¯è§£é‡Šæ€§æ¡†æ¶å®ç°

**è®ºæ–‡è¦æ±‚**ï¼šæä¾›å¤šå±‚æ¬¡çš„é¢„æµ‹è§£é‡Š
- ç»„ä»¶è´¡çŒ®åˆ†æ
- ç‰¹å¾é‡è¦æ€§è¯„ä¼°  
- æ‰°åŠ¨æ•æ„Ÿæ€§åˆ†æ

**å¤ç°å®ç°** ï¼š
```python
# utils/interpretability.py
class InterpretabilityAnalyzer:
    def analyze_component_contribution(self, model, data):
        """åˆ†æå‘¨æœŸæ€§å’Œè¡¥å¿æ¨¡å—çš„é¢„æµ‹è´¡çŒ®"""
        
    def feature_importance_analysis(self, model, data):
        """åŸºäºæ¢¯åº¦çš„ç‰¹å¾é‡è¦æ€§åˆ†æ"""
        
    def perturbation_analysis(self, model, data):
        """æ‰°åŠ¨æ•æ„Ÿæ€§åˆ†æ"""
```

---

##  å®éªŒç»“æœä¸åˆ†æ

###  è®­ç»ƒç»“æœå±•ç¤º

#### 1. æ¨¡å‹é¢„æµ‹æ•ˆæœå¯¹æ¯”

**é˜¿é‡Œå·´å·´æ•°æ®é›†é¢„æµ‹ç»“æœ**ï¼š
![é˜¿é‡Œå·´å·´é¢„æµ‹ç»“æœ](forecast_alibaba.png)

**Azureæ•°æ®é›†é¢„æµ‹ç»“æœ**ï¼š
![Azureé¢„æµ‹ç»“æœ](forecast_azure.png)

#### 2. è®­ç»ƒè¿‡ç¨‹åˆ†æ

**é˜¿é‡Œå·´å·´æ•°æ®é›†è®­ç»ƒæ›²çº¿**ï¼š
![é˜¿é‡Œå·´å·´è®­ç»ƒæŸå¤±](loss_curve_alibaba.png)

**Azureæ•°æ®é›†è®­ç»ƒæ›²çº¿**ï¼š
![Azureè®­ç»ƒæŸå¤±](loss_curve_azure.png)

### ğŸ“ˆ æ€§èƒ½æŒ‡æ ‡å¯¹æ¯”

#### é˜¿é‡Œå·´å·´æ•°æ®é›†ç»“æœå¯¹æ¯”

| æŒ‡æ ‡ | è®ºæ–‡æŠ¥å‘Š | å¤ç°ç»“æœ | ç›¸å¯¹å·®å¼‚ |
|------|----------|----------|----------|
| **MAE** | 13.45 | 14.09 | +4.8% |
| **RMSE** | 17.86 | 17.91 | +0.3% |
| **MAPE** | 11.29% | 11.21% | -0.7% |
| **sMAPE** | 10.85% | 10.92% | +0.6% |

**å¹³å‡åå·®**: 2.2% 

#### Azureæ•°æ®é›†ç»“æœå¯¹æ¯”

**æ¨¡å‹æ€§èƒ½å¯¹æ¯”å›¾**ï¼š
![æ¨¡å‹æ€§èƒ½å¯¹æ¯”](model_comparison_azure.png)

| æŒ‡æ ‡ | è®ºæ–‡æŠ¥å‘Š | å¤ç°ç»“æœ | ç›¸å¯¹å·®å¼‚ |
|------|----------|----------|----------|
| **MAE** | 0.087 | 0.089 | +2.3% |
| **RMSE** | 0.143 | 0.141 | -1.4% |
| **MAPE** | 8.45% | 8.67% | +2.6% |
| **sMAPE** | 8.12% | 8.29% | +2.1% |

**å¹³å‡åå·®**: 2.1% 

---

## å¯è§£é‡Šæ€§åˆ†æç»“æœ

### 1. ä¿¡å·åˆ†è§£

**é˜¿é‡Œå·´å·´æ•°æ®ä¿¡å·åˆ†è§£**ï¼š
![é˜¿é‡Œå·´å·´ä¿¡å·åˆ†è§£](signal_decomposition_alibaba.png)

**Azureæ•°æ®ä¿¡å·åˆ†è§£**ï¼š
![Azureä¿¡å·åˆ†è§£](signal_decomposition_azure.png)

### 2. ç‰¹å¾é‡è¦æ€§åˆ†æ

**é˜¿é‡Œå·´å·´ç‰¹å¾é‡è¦æ€§**ï¼š
![é˜¿é‡Œå·´å·´ç‰¹å¾é‡è¦æ€§](feature_importance_alibaba.png)

**Azureç‰¹å¾é‡è¦æ€§**ï¼š
![Azureç‰¹å¾é‡è¦æ€§](feature_importance_azure.png)

### 3. æ‰°åŠ¨æ•æ„Ÿæ€§åˆ†æ

**é˜¿é‡Œå·´å·´æ‰°åŠ¨åˆ†æ**ï¼š
![é˜¿é‡Œå·´å·´æ‰°åŠ¨åˆ†æ](perturbation_analysis_alibaba.png)

**Azureæ‰°åŠ¨åˆ†æ**ï¼š
![Azureæ‰°åŠ¨åˆ†æ](perturbation_analysis_azure.png)

### 4. å¯è§£é‡Šæ€§åˆ†ææ€»ç»“

ä»å¯è§£é‡Šæ€§åˆ†æç»“æœå¯ä»¥çœ‹å‡ºï¼š

1. **ä¿¡å·åˆ†è§£æœ‰æ•ˆæ€§** ï¼š
    å‘¨æœŸæ€§ç»„ä»¶æˆåŠŸæ•è·äº†å·¥ä½œè´Ÿè½½çš„è§„å¾‹æ€§æ¨¡å¼
    æ®‹å·®ç»„ä»¶æœ‰æ•ˆå»ºæ¨¡äº†å±€éƒ¨æ³¢åŠ¨å’Œå¼‚å¸¸
    åˆ†è§£è´¨é‡ä¸è®ºæ–‡æè¿°é«˜åº¦ä¸€è‡´

2. **ç‰¹å¾é‡è¦æ€§æ’åº** ï¼š
    æ—¶é—´ç‰¹å¾(å°æ—¶ã€æ˜ŸæœŸ)é‡è¦æ€§æœ€é«˜ï¼Œç¬¦åˆäº‘å·¥ä½œè´Ÿè½½çš„æ—¶é—´å‘¨æœŸæ€§
    å†å²å€¼ç‰¹å¾æ˜¾ç¤ºé€’å‡é‡è¦æ€§ï¼ŒéªŒè¯äº†æ—¶é—´åºåˆ—ä¾èµ–å…³ç³»
    CPUã€å†…å­˜ä½¿ç”¨ç‡ç­‰èµ„æºç‰¹å¾é‡è¦æ€§é€‚ä¸­

3. **æ¨¡å‹é²æ£’æ€§** ï¼š
    æ‰°åŠ¨åˆ†ææ˜¾ç¤ºæ¨¡å‹å¯¹å°å¹…åº¦å™ªå£°å…·æœ‰è‰¯å¥½æŠ—å¹²æ‰°èƒ½åŠ›
    å…³é”®ç‰¹å¾æ‰°åŠ¨æ—¶é¢„æµ‹è¯¯å·®æ˜¾è‘—å¢åŠ ï¼ŒéªŒè¯äº†ç‰¹å¾é‡è¦æ€§
    æ•´ä½“æ¨¡å‹ç¨³å®šæ€§ä¸è®ºæ–‡å£°æ˜ä¸€è‡´
---

##  å¤ç°éªŒè¯æ¸…å•

###  å·²å®ŒæˆéªŒè¯é¡¹ç›®

- **ç®—æ³•å®ç°éªŒè¯**ï¼šæ ¸å¿ƒç®—æ³•ä¸è®ºæ–‡å®Œå…¨ä¸€è‡´
- **æ¶æ„è®¾è®¡éªŒè¯**ï¼šå¤šå—çº§è”ç»“æ„ç²¾ç¡®å¤ç°  
- **æ•°å­¦å…¬å¼éªŒè¯**ï¼šæ‰€æœ‰å…¬å¼æ¨å¯¼å’Œå®ç°æ­£ç¡®
- **è¶…å‚æ•°éªŒè¯**ï¼šå…³é”®å‚æ•°ä¸è®ºæ–‡è®¾ç½®åŒ¹é…
- **æ•°æ®é›†éªŒè¯**ï¼šæ ‡å‡†æ•°æ®é›†é¢„å¤„ç†æ­£ç¡®
- **è®­ç»ƒæµç¨‹éªŒè¯**ï¼šä¼˜åŒ–å™¨ã€æŸå¤±å‡½æ•°ã€å­¦ä¹ ç‡ç­‰
- **è¯„ä¼°æŒ‡æ ‡éªŒè¯**ï¼šMAEã€RMSEã€MAPEç­‰è®¡ç®—æ­£ç¡®
- **å¯è§£é‡Šæ€§éªŒè¯**ï¼šç‰¹å¾é‡è¦æ€§ã€æ‰°åŠ¨åˆ†æç­‰
- **ç»“æœå¯é‡ç°æ€§**ï¼šå¤šæ¬¡è¿è¡Œç»“æœç¨³å®š
---

##  è”ç³»ä¸åé¦ˆ

**é¡¹ç›®ä¿¡æ¯**ï¼š
- å¤ç°ä½œè€…ï¼šå‘¨å¿—é¹
- å®Œæ•´é¡¹ç›®ä»£ç ï¼ˆæœ¬åœ°ï¼‰ï¼š`/media/h3c/users/fanqilin1/zhouzp/DeIP4CW`

**æŠ€æœ¯æ”¯æŒ**ï¼š
- å¦‚æœ‰æŠ€æœ¯é—®é¢˜æˆ–æ”¹è¿›å»ºè®®ï¼Œæ¬¢è¿äº¤æµè®¨è®º
- é¡¹ç›®æŒç»­ç»´æŠ¤å’Œæ›´æ–°ä¸­

---

##  å‚è€ƒæ–‡çŒ®

1. **åŸè®ºæ–‡**ï¼šWang, B., Shi, X., & Shang, M. (2023). A Self-decoupled Interpretable Prediction Framework for Highly-Variable Cloud Workloads. DASFAA 2023, LNCS 13943, pp. 588-603.

2. **æ•°æ®é›†**ï¼š
   - Alibaba Cluster Trace v2018
   - Azure Public Dataset 2019

3. **åŸºçº¿æ–¹æ³•**ï¼š
   - ARIMA, LSTM, Transformer, N-BEATSç­‰ç»å…¸æ—¶é—´åºåˆ—é¢„æµ‹æ–¹æ³•

---

##  é™„å½•

### A. å®Œæ•´å®éªŒé…ç½®

```json
{
    "model_config": {
        "input_dim": 1,
        "hidden_dim": 128,
        "output_dim": 1,
        "seq_len": 96,
        "pred_len": 24,
        "num_blocks": 3
    },
    "training_config": {
        "epochs": 100,
        "batch_size": 32,
        "learning_rate": 0.001,
        "optimizer": "Adam",
        "scheduler": "ReduceLROnPlateau",
        "early_stopping": 15
    },
    "data_config": {
        "train_ratio": 0.6,
        "val_ratio": 0.2,
        "test_ratio": 0.2,
        "decompose_method": "advanced"
    }
}
``` 